<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, viewport-fit=cover, minimum-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<title>Tip, Pay &amp; Time ‚Ä¢ App</title>
<meta content="#0b1220" name="theme-color"/>
<style>
    :root{
      --bg:#0b1220;
      --surface:#0f172a;
      --panel:#111827;
      --ring:#243244;
      --muted:#9aa5b4;
      --text:#f1f5f9;
      --accent:#22c55e;
      --danger:#ef4444;
      --info:#38bdf8;
      --accent2:#a78bfa;
      --tab:#0f1c33;
      --tabActive:#1a2d4d;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --maxContent: 2000px;
    }
    *{box-sizing:border-box;font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;min-width:0}
    html,body{height:100%;background:var(--bg);color:var(--text);overflow-x:hidden}
    body{margin:0;word-wrap:break-word;overflow-wrap:break-word}
    img,svg,canvas,video{max-width:100%;height:auto}
    input,select,button{max-width:100%}
    /* App Shell */
    .app-shell{height:100dvh;display:flex;flex-direction:column;overscroll-behavior:none}
    .appbar{
      position:relative;display:flex;align-items:center;gap:10px;
      background:linear-gradient(180deg,#0d1526, #0b1220);
      border-bottom:1px solid rgba(255,255,255,.06);
      padding: max(12px, env(safe-area-inset-top)) 16px 12px 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
      z-index:10;
      max-width:100%;
      overflow:hidden;
    }
    .app-title{margin:0;font-weight:700;font-size:18px;letter-spacing:.01em;flex:1;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .icon-btn{
      width:36px;height:36px;border-radius:10px;border:1px solid rgba(255,255,255,.08);
      display:grid;place-items:center;background:rgba(255,255,255,.03);cursor:pointer;flex:0 0 auto
    }
    .content{
      flex:1;overflow:auto;scroll-behavior:smooth;
      padding:12px 14px calc(90px + env(safe-area-inset-bottom));
      background:
        radial-gradient(1200px 500px at 100% -50%, rgba(104,117,245,.06), transparent 60%),
        radial-gradient(900px 600px at -20% 120%, rgba(34,197,94,.06), transparent 60%);
      max-width:100%;
    }
    .container{max-width:var(--maxContent);margin:0 auto}
    .card{border-radius:16px;padding:16px;margin:16px 0;background:var(--surface);border:1px solid var(--ring);box-shadow:var(--shadow)}
    .title{margin:0 0 8px;font-size:16px;font-weight:700}
    .subhead{font-size:13px;color:var(--muted);margin:6px 0 6px}
    .input{display:flex;align-items:center;gap:10px;background:rgba(255,255,255,.03);border:1px solid var(--ring);border-radius:12px;padding:12px}
    .input input,.input select{flex:1 1 0;background:transparent;border:0;outline:0;color:var(--text);font-size:16px;width:100%}
    .prefix{opacity:.9;font-size:16px;flex:0 0 auto}
    .btn{appearance:none;border:1px solid var(--ring);background:#13243e;color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;text-align:center;transition:transform .03s ease, background .2s; width:100%}
    .btn:active{transform:scale(.98)}
    .btn.active{border-color:var(--accent);box-shadow:0 0 0 4px rgba(34,197,94,.2) inset}
    .grid{display:grid;grid-template-columns:1fr;gap:10px;width:100%}
    @media(min-width:520px){.grid.two{grid-template-columns:repeat(2,minmax(0,1fr))}.grid.three{grid-template-columns:repeat(3,minmax(0,1fr))}}
    .totals{display:grid;gap:10px;margin-top:10px;width:100%}
    @media(min-width:420px){.totals{grid-template-columns:repeat(3,minmax(0,1fr))}}
    .box{background:rgba(255,255,255,.04);border:1px solid var(--ring);border-radius:12px;padding:10px;text-align:center}
    .box h3{margin:0 0 4px;font-size:12px;color:var(--muted);font-weight:600}
    .total{font-size:22px;font-weight:800}
    .row{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.03);border:1px solid var(--ring);border-radius:12px;padding:12px}
    .neg{color:var(--danger)}
    .net{color:var(--accent);font-weight:800}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    section[role="tabpanel"]{display:none}
    section[role="tabpanel"].active{display:block}
    .tabbar{
      position:fixed;left:0;right:0;bottom:0;z-index:15;
      padding:8px max(12px, env(safe-area-inset-left)) calc(8px + env(safe-area-inset-bottom)) max(12px, env(safe-area-inset-right));
      background:rgba(13,21,38,.86);backdrop-filter: blur(10px);
      border-top:1px solid rgba(255,255,255,.06);
      max-width:100%;
    }
    .tabs{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:8px;width:100%;max-width:var(--maxContent);margin:0 auto}
    .tab{
      --c:rgba(255,255,255,.06);
      display:flex;flex-direction:column;align-items:center;gap:6px;
      padding:10px 6px;border-radius:14px;border:1px solid var(--c);
      background:linear-gradient(180deg, var(--tab), #0c162a);
      text-align:center;color:var(--text);cursor:pointer;user-select:none;min-width:0
    }
    .tab.active{border-color:rgba(34,197,94,.35);background:linear-gradient(180deg, var(--tabActive), #132744);box-shadow:0 4px 18px rgba(34,197,94,.12)}
    .tab svg{width:20px;height:20px;opacity:.9;flex:0 0 auto}
    .tab span{font-size:11px;line-height:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}
    #tipOut{color:var(--accent)}
    #totalOut{color:var(--danger)}
    #percentOut{color:var(--info)}
    .pill{background:rgba(255,255,255,.04);border:1px solid var(--ring);border-radius:14px;padding:14px;text-align:center}
    .pill h3{margin:0 0 6px;font-size:12px;color:var(--muted);font-weight:600}
    .pill .big{display:block;font-size:22px;font-weight:800}
    .hl{color:var(--info)} .hl2{color:var(--accent2)} .ok{color:var(--accent)}
    .mode{display:flex;gap:8px;background:rgba(255,255,255,.05);border:1px solid var(--ring);padding:6px;border-radius:12px;width:100%}
    .mode button{flex:1;padding:10px;border-radius:10px;border:1px solid transparent;background:transparent;color:var(--text);cursor:pointer;min-width:0}
    .mode button.active{border-color:rgba(255,255,255,.2);background:rgba(255,255,255,.06)}
    .sa-bottom{height: env(safe-area-inset-bottom)}

    /* ---------- HOME OVERLAY ---------- */
    .home-overlay{
      position:fixed;inset:0;z-index:999;
      display:grid;place-items:center;
      background:
        radial-gradient(1200px 500px at 100% -50%, rgba(104,117,245,.10), transparent 60%),
        radial-gradient(900px 600px at -20% 120%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg,#0d1526,#0b1220);
      transition:opacity .5s ease, visibility .5s ease;
    }
    .home-overlay.hide{opacity:0;visibility:hidden}
    .welcome-card{
      width:min(82vw, 360px); aspect-ratio:1/1; 
      background:linear-gradient(180deg,#0e1628,#0b1220);
      border:1px solid var(--ring); border-radius:24px; padding:18px;
      box-shadow: 0 20px 60px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.04);
      position:relative; overflow:hidden; isolation:isolate;
    }
    .welcome-title{font-size:18px;letter-spacing:.06em;color:var(--muted);margin:0 0 6px;text-transform:uppercase}
    .welcome-headline{font-size:28px;font-weight:800;margin:0 0 10px;line-height:1.3;text-align:center;display:flex;flex-direction:column;justify-content:center;flex:1;}
    .welcome-sub{font-size:13px;color:var(--muted);margin:0 0 14px}
    .enter-btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      width:100%;padding:12px 14px;border-radius:14px;cursor:pointer;
      background:linear-gradient(180deg,#143154,#10243f); border:1px solid var(--ring); color:var(--text);
      box-shadow: var(--shadow);
      transition: transform .12s ease, box-shadow .2s ease, opacity .4s ease;
      font-weight:700; letter-spacing:.02em;
    }
    .enter-btn:active{transform:translateY(1px) scale(.99)}

    /* Animated ring inside the card */
    .ring-wrap{
      position:absolute; inset:0; z-index:-1; pointer-events:none; opacity:.8;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.35));
    }
    .ring{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:120%; aspect-ratio:1/1; border-radius:50%;
      background: conic-gradient(from 0deg, transparent 0 20%, rgba(56,189,248,.35) 20% 35%, transparent 35% 55%, rgba(167,139,250,.35) 55% 70%, transparent 70% 100%);
      mask: radial-gradient(circle at 50% 50%, transparent 48%, black 52%);
      animation: spin 10s linear infinite;
    }
    .ring.r2{width:100%; animation-duration: 16s; opacity:.8}
    .ring.r3{width:80%;  animation-duration: 22s; opacity:.7}

    @keyframes spin{to{transform:translate(-50%,-50%) rotate(360deg)}}

    /* Floating sparkles */
    .sparkle{
      position:absolute; width:6px; height:6px; border-radius:50%; background:currentColor; opacity:.7;
      filter: blur(.2px);
      animation: float 6s ease-in-out infinite;
    }
    .s1{ color:#22c55e; left:10%; top:72%; animation-delay:.2s}
    .s2{ color:#38bdf8; right:12%; top:18%; animation-delay:1s}
    .s3{ color:#a78bfa; left:20%; top:20%; animation-delay:2.2s}
    .s4{ color:#38bdf8; right:18%; bottom:14%; animation-delay:3.1s}
    .s5{ color:#22c55e; left:48%; top:6%; animation-delay:4s}
    @keyframes float{
      0%,100%{ transform:translateY(0) scale(1) }
      50%{ transform:translateY(-10px) scale(1.15) }
    }

    /* Content dim blur behind card */
    .glow{
      position:absolute; inset:-20%;
      background: radial-gradient(300px 300px at 65% 30%, rgba(56,189,248,.18), transparent 60%),
                  radial-gradient(360px 360px at 35% 70%, rgba(34,197,94,.16), transparent 65%),
                  radial-gradient(500px 500px at 50% 50%, rgba(167,139,250,.12), transparent 70%);
      filter: blur(40px); opacity:.9; z-index:-2;
    }

    /* Home badge */
    .badge{display:inline-block;font-size:24px;padding:10px 14px;border-radius:999px;border:1px solid var(--ring);background:rgba(255,255,255,.04);margin-bottom:10px}

    /* Reduce motion preference */
    @media (prefers-reduced-motion: reduce){
      .ring,.ring.r2,.ring.r3{animation:none}
      .sparkle{animation:none}
      .home-overlay{transition:none}
    }
  
    /* Enlarge 'cini.moD' in welcome headline */
    .welcome-headline span{font-size:34px; line-height:1.1}
    
/* ===== Mobile-fit tweaks (added) ===== */
@media (max-width: 400px){
  .appbar { padding-left: 10px; padding-right: 10px; }
  .app-title { font-size: 16px; }
  .title { font-size: 15px; }
  .welcome-headline { font-size: 24px; }
  .welcome-headline span { font-size: 28px; }
  .grid.two { grid-template-columns: 1fr !important; }
  .grid.three { grid-template-columns: 1fr !important; }
  .totals { grid-template-columns: 1fr !important; }
  .tab { padding: 10px 4px; }
  .tab span { display: none; }
  .tabs { gap: 6px; }
  .card { margin: 12px 0; padding: 14px; }
  .input { padding: 10px; }
  .enter-btn { padding: 12px; }
}

/* Slightly larger small phones */
@media (min-width: 401px) and (max-width: 480px){
  .grid.three { grid-template-columns: repeat(2, minmax(0,1fr)); }
  .totals { grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* Ensure the welcome card never overflows short viewports */
.welcome-card{
  width: min(92vw, 360px);
  max-height: 86vh;
  aspect-ratio: auto;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

/* Protect against content underlap with the tabbar */
.content {
  padding-bottom: 120px; /* will be corrected by JS based on actual tabbar height */
}


/* ===== Ensure Enter button is never hidden on mobile (added) ===== */
:root {
  /* Respect iOS/Android safe areas */
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --tabbar-h: 90px; /* updated dynamically via JS */
}

/* Give the home overlay breathing room at the bottom so buttons clear the tab bar */
#homeOverlay {
  padding-bottom: calc(var(--tabbar-h) + var(--safe-bottom) + 24px) !important;
}

/* If the Enter button sits inside a footer/actions row, keep it visible */
.welcome-actions,
.enter-row,
.enter-footer {
  position: sticky;
  bottom: calc(var(--safe-bottom) + 12px);
  padding-bottom: var(--safe-bottom);
  z-index: 5;
}

/* As an extra guard, make sure the main welcome card isn't forced offscreen */
.welcome-card {
  max-height: calc(92vh - var(--safe-bottom));
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}


    /* DASHBOARD */
    .dash-clocks{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap:10px;
      margin-top:8px;
    }
    .clock-card{
      background:rgba(255,255,255,.04);
      border:1px solid var(--ring);
      border-radius:14px;
      padding:10px 12px;
      text-align:center;
      box-shadow:0 6px 18px rgba(0,0,0,.25);
    }
    .clock-label{
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.08em;
      margin-bottom:4px;
    }
    .clock-time{
      font-family:system-ui, -apple-system, BlinkMacSystemFont, "SF Mono", Menlo, monospace;
      font-size:22px;
      font-weight:700;
    }
    .wx-current{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:14px;
      background:rgba(15,23,42,.9);
      border:1px solid var(--ring);
    }
    .wx-temp{
      font-size:32px;
      font-weight:800;
    }
    .wx-main{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .wx-cond{
      font-size:15px;
      font-weight:600;
    }
    .wx-extra{
      font-size:12px;
      color:var(--muted);
    }
    .wx-grid{
      display:grid;
      grid-template-columns:repeat(4, minmax(0,1fr));
      gap:8px;
    }
    @media (max-width: 480px){
      .wx-grid{
        grid-template-columns:repeat(2, minmax(0,1fr));
      }
    }
    .wx-hour{
      background:rgba(255,255,255,.03);
      border:1px solid var(--ring);
      border-radius:12px;
      padding:8px;
      text-align:center;
      font-size:12px;
    }
    .wx-hour-time{
      font-weight:600;
      margin-bottom:4px;
    }
    .wx-hour-temp{
      font-size:16px;
      font-weight:700;
      margin-bottom:2px;
    }
    .wx-hour-cond{
      font-size:11px;
      color:var(--muted);
    }

/* Force all clocks on one line with horizontal scroll if needed */
.dash-clocks{
  display:flex !important;
  flex-wrap:nowrap !important;
  gap:18px !important;
  overflow-x:auto !important;
  padding-bottom:6px;
}

/* Make each clock card narrower so they fit better */
.clock-card{
  min-width:120px !important;
}

/* Force next8 and next8b into one long row */
.wx-grid{
  display:flex !important;
  flex-wrap:nowrap !important;
  gap:16px !important;
  overflow-x:auto !important;
  padding-bottom:6px;
}

.wx-hour{
  min-width:120px !important;
}

.dash-clocks{
  display:grid !important;
  grid-template-columns: repeat(6, 1fr) !important;
  gap:20px !important;
  overflow-x:hidden !important;
}

.wx-grid{
  display:grid !important;
  grid-template-columns: repeat(8, 1fr) !important;
  gap:20px !important;
  overflow-x:hidden !important;
}

/* DASHBOARD LAYOUT WITH NEWS COLUMN */
.dash-layout{
  display:flex;
  gap:18px;
  align-items:flex-start;
}
.dash-main{
  flex:2;
  min-width:0;
}
.dash-news{
  flex:1;
  min-width:260px;
}
.news-list{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.news-item{
  padding:10px 12px;
  border-radius:12px;
  background:rgba(15,23,42,.9);
  border:1px solid var(--ring);
}
.news-title{ font-size:13px; font-weight:600; margin-bottom:4px; color:#ffffff !important; }
.news-summary{
  font-size:12px;
  color:var(--muted);
}

/* Stack vertically on smaller screens */
@media (max-width: 960px){
  .dash-layout{
    flex-direction:column;
  }
  .dash-news{
    width:100%;
    min-width:0;
  }
}

html, body{
  overflow:hidden !important;
  height:100%;
}

html, body{
  overflow:hidden !important;
  height:100% !important;
  margin:0 !important;
}
.container{
  height:100% !important;
  overflow:hidden !important;
}

.news-time{
  font-size:11px;
  color:var(--muted);
  margin-top:4px;
}

/* Force dashboard to full height with no scroll */
html, body{
  height:100vh !important;
  overflow:hidden !important;
}

/* Layout: main left + right column fit vertically */
.dash-layout{
  height:100%;
  display:flex;
  flex-direction:row;
  align-items:flex-start;
}

/* Left side scrolls internally if needed */
.dash-main{
  height:100%;
  overflow:hidden;
}

/* Right side: fit full height, no scroll */
.dash-news{
  height:100%;
  overflow:hidden !important;
}

/* Fit the news card fully inside */
.dash-news .card{
  height:100%;
  display:flex;
  flex-direction:column;
}

/* News list fills available space but no scroll */
.news-list{
  flex:1;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}

/* Each item auto sizes */
.news-item{
  flex:1;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
}

/* Prevent overflow inside items */
.news-item *{
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Smaller bottom nav buttons */
.tabbar{
  height:48px !important;
}
.tabbar .tabs .tab{
  padding:4px 6px !important;
  font-size:11px !important;
  height:38px !important;
  border-radius:6px !important;
}
.tabbar .tabs .tab svg{
  width:14px !important;
  height:14px !important;
}

/* FINAL dashboard layout tweaks: no page scroll, content fully visible above footer */
.content{
  flex:1 !important;
  overflow:hidden !important;
  padding:12px 14px 16px 14px !important;
}
.dash-layout{
  height:100%;
  display:flex;
  align-items:flex-start;
}
.dash-main{
  height:100%;
  overflow:hidden;
}
.dash-news{
  height:100%;
  overflow:hidden;
}

.clock-date{ font-size:11px; color:#fcd34d !important; margin-top:2px; }

.wx-row{
  display:flex;
  gap:20px;
  align-items:flex-start;
  margin-bottom:20px;
}
.wx-row .card{
  flex:1;
}

/* Smaller bottom buttons to fit one line */
.tabbar{
  height:42px !important;
}
.tabbar .tabs .tab{
  padding:2px 4px !important;
  font-size:10px !important;
  height:32px !important;
  border-radius:5px !important;
  min-width: 45px !important;
}
.tabbar .tabs{
  gap:4px !important;
}
.tabbar .tabs .tab svg{
  width:12px !important;
  height:12px !important;
}

/* Force all bottom tabs to fit in one line and be fully visible */
.tabbar{
  height:40px !important;
}
.tabbar .tabs{
  display:flex !important;
  flex-wrap:nowrap !important;
  justify-content:space-between !important;
  overflow-x:hidden !important;
  gap:2px !important;
}
.tabbar .tabs .tab{
  flex:1 1 0 !important;
  padding:1px 2px !important;
  font-size:9px !important;
  height:30px !important;
  border-radius:4px !important;
  min-width:0 !important;
}
.tabbar .tabs .tab svg{
  width:11px !important;
  height:11px !important;
  margin-right:2px !important;
}

/* Option A: Slightly larger, cleaner bottom tabs without wrapping */
.tabbar{
  height:48px !important;
}
.tabbar .tabs{
  gap:4px !important;
}
.tabbar .tabs .tab{
  flex:1 1 0 !important;
  padding:4px 6px !important;
  font-size:11px !important;
  height:36px !important;
  border-radius:6px !important;
  min-width:0 !important;
}
.tabbar .tabs .tab svg{
  width:14px !important;
  height:14px !important;
  margin-right:4px !important;
}

/* Further tweak: remove icons so labels have room, keep one clean line */
.tabbar .tabs .tab svg{
  display:none !important;
  margin:0 !important;
}
.tabbar .tabs .tab{
  flex:1 1 0 !important;
  padding:4px 8px !important;
  font-size:12px !important;
  height:34px !important;
}

/* Final bottom bar fix: no vertical squish, sits slightly above screen edge */
.tabbar{
  height:auto !important;
  padding-top:6px !important;
  padding-bottom:calc(10px + env(safe-area-inset-bottom)) !important;
}
.tabbar .tabs .tab{
  height:auto !important;
  padding-top:6px !important;
  padding-bottom:6px !important;
}

/* FINAL OVERRIDE: comfortable, single-line bottom tabs */
.content{
  padding-bottom:64px !important; /* leave room for a taller tabbar */
}
.tabbar{
  height:56px !important;
  padding-top:8px !important;
  padding-bottom:8px !important;
}
.tabbar .tabs .tab{
  font-size:13px !important;
  padding:6px 10px !important;
}

/* Option A: Bigger comfortable tabs with emojis */
.tabbar{
  height:60px !important;
  padding:8px 0 !important;
}
.tabbar .tabs{
  gap:6px !important;
}
.tabbar .tabs .tab{
  flex:1 1 0 !important;
  padding:8px 10px !important;
  font-size:15px !important;
  height:44px !important;
  border-radius:10px !important;
  min-width:0 !important;
}

/* ===== Section text color accents for visual separation ===== */

/* Dashboard: clocks, weather, news */
#screen-dash .card .title{
  color: var(--accent2);
}
#screen-dash .card .subhead{
  color: var(--info);
}
.dash-clocks .clock-label{
  color: var(--info);
}
.wx-cond{
  color: var(--accent);
}
.wx-hour-time{
  color: var(--info);
}
.wx-hour-cond{
  color: var(--muted);
}
.news-title{ font-size:13px; font-weight:600; margin-bottom:4px; color:#ffffff !important; }

/* Tip Calculator */
#screen-tip .card .title{
  color: var(--accent);
}

/* Salary Calculator */
#screen-salary .card .title{
  color: var(--info);
}

/* Paycheck After Taxes */
#screen-pay .card .title{
  color: var(--danger);
}

/* Your Time & Their Time */
#screen-time .card .title{
  color: var(--accent2);
}

/* Southwest Points tools */
#screen-sw .card .title{
  color: var(--accent);
}
#screen-sw .pill h3{
  color: var(--info);
}

.news-date{ color:#fcd34d !important; } /* yellow */
.news-timepart{ color:#fb923c !important; } /* orange */

.dash-news .title{ font-size:16px; font-weight:700; margin-bottom:8px; color:#ffffff !important; }

.dash-title,
.dash-weather h2,
#currentWeatherTitle,
#tomorrowWeatherTitle {
  color:#ffffff !important;
}

/* Force these specific dashboard titles to white */
.dash-main > .card:first-child .title{ color:#ffffff !important; }           /* Dashboard */
.wx-row > .card:first-child .title{ color:#ffffff !important; }             /* Current Weather */
.wx-row > .card:last-child .title{ color:#ffffff !important; }              /* Tomorrow's Weather */
</style>
</head>
<body>
<div class="app-shell">
<header aria-label="App header" class="appbar">
<button aria-label="Scroll to top" class="icon-btn" id="btnBack" title="Scroll to top">
<svg aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
<path d="M12 19V5M5 12l7-7 7 7"></path>
</svg>
</button>
<h1 class="app-title" id="appTitle">Dashboard</h1>
<button aria-label="Copy summary" class="icon-btn" id="btnCopy" title="Copy summary">
<svg aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
<rect height="13" rx="2" width="13" x="9" y="9"></rect>
<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
</svg>
</button>
</header>
<!-- HOME OVERLAY -->
<main class="content" id="content" tabindex="-1">
<div class="container">
<!-- DASHBOARD -->
<section aria-labelledby="tab-dash" class="active" id="screen-dash" role="tabpanel">
<div class="dash-layout"><div class="dash-main"><div class="card">
<h2 class="title">Dashboard</h2>
<div class="subhead">Network-wide clocks</div>
<div class="dash-clocks">
<div class="clock-card">
<div class="clock-label">Hawai'i</div>
<div class="clock-time" id="clock-hi">--:--</div>
<div class="clock-date">--/--</div></div>
<div class="clock-card">
<div class="clock-label">Pacific</div>
<div class="clock-time" id="clock-pt">--:--</div>
<div class="clock-date">--/--</div></div>
<div class="clock-card">
<div class="clock-label">Mountain</div>
<div class="clock-time" id="clock-mt">--:--</div>
<div class="clock-date">--/--</div></div>
<div class="clock-card">
<div class="clock-label">Central</div>
<div class="clock-time" id="clock-ct">--:--</div>
<div class="clock-date">--/--</div></div>
<div class="clock-card">
<div class="clock-label">Eastern</div>
<div class="clock-time" id="clock-et">--:--</div>
<div class="clock-date">--/--</div></div>
<div class="clock-card">
<div class="clock-label">Zulu</div>
<div class="clock-time" id="clock-z">--:--</div>
<div class="clock-date">--/--</div></div>
</div>
</div><div class="wx-row"><div class="card">
<h2 class="title">Current Weather</h2>
<div class="subhead">Albuquerque, NM (Downtown)</div>
<div class="wx-current" id="wx-current">
<div class="wx-temp">--¬∞</div>
<div class="wx-main">
<div class="wx-cond">Loading...</div>
<div class="wx-extra" id="wx-extra">Updating forecast</div>
</div>
</div>
</div><div class="card">
<h2 class="title">Tomorrow's Weather</h2>
<div class="subhead">Albuquerque, NM (Downtown)</div>
<div class="wx-current" id="wx-tomorrow">
<div class="wx-temp" id="wx-tomorrow-hi">--¬∞</div>
<div class="wx-main">
<div class="wx-cond" id="wx-tomorrow-cond">Loading...</div>
<div class="wx-extra" id="wx-tomorrow-extra">High / Low</div>
</div>
</div>
</div></div>
<div class="card">
<h2 class="title">Next 8 hours</h2>
<div class="wx-grid" id="wx-next8">
<!-- Filled by JS -->
</div>
</div><div class="card">
<h2 class="title">Following 8 hours</h2>
<div class="wx-grid" id="wx-next8b">
<!-- Filled by JS -->
</div>
</div></div><aside class="dash-news"><div class="card">
<h2 class="title">Top U.S. News</h2>
<div class="news-list" id="news-list">
<p class="hint">Loading top headlines‚Ä¶</p>
</div>
</div></aside></div></section>
<!-- TIP -->
<section aria-labelledby="tab-tip" id="screen-tip" role="tabpanel">
<div class="card">
<h2 class="title">Tip Calculator</h2>
<div class="subhead">Bill amount pre tax</div>
<div class="input"><span class="prefix">$</span><input autocomplete="off" id="bill" inputmode="decimal" placeholder="0.00"/></div>
<div class="subhead">Preset percentage</div>
<div aria-label="Choose tip %" class="grid two" role="group">
<button class="btn tip" data-tip="20">20%</button>
<button class="btn tip" data-tip="25">25%</button>
<button class="btn tip" data-tip="30">30%</button>
<button class="btn tip" data-tip="35">35%</button>
</div>
<div class="subhead">Custom percentage</div>
<div class="input"><input id="customTip" inputmode="decimal" placeholder="Custom Percentage"/><span class="prefix">%</span></div>
<div class="totals">
<div class="box"><h3>Tip</h3><div class="total" id="tipOut">$0.00</div></div>
<div class="box"><h3>Total</h3><div class="total" id="totalOut">$0.00</div></div>
<div class="box"><h3>Tip %</h3><div class="total" id="percentOut">0%</div></div>
</div>
<div class="grid two" style="margin-top:10px">
<button class="btn" id="reset">Reset</button>
<button class="btn" id="copy">Copy summary</button>
</div>
</div>
</section>
<!-- SALARY -->
<section aria-labelledby="tab-salary" id="screen-salary" role="tabpanel">
<div class="card">
<h2 class="title">Salary Calculator</h2>
<div class="grid three">
<div>
<div class="subhead">Hourly rate</div>
<div class="input"><span class="prefix">$</span><input id="hourly" inputmode="decimal" placeholder="0.00" type="text"/></div>
</div>
<div>
<div class="subhead">Monthly pay</div>
<div class="input"><span class="prefix">$</span><input id="monthly" inputmode="decimal" placeholder="0.00" type="text"/></div>
</div>
<div>
<div class="subhead">Annual salary</div>
<div class="input"><span class="prefix">$</span><input id="annual" inputmode="decimal" placeholder="0.00" type="text"/></div>
</div>
</div>
<p class="hint">Assumes 2,080 hours per year (40 hrs/week √ó 52 weeks).</p>
</div>
</section>
<!-- PAYCHECK -->
<section aria-labelledby="tab-pay" id="screen-pay" role="tabpanel">
<div class="card">
<h2 class="title">Paycheck After Taxes (NM)</h2>
<div class="grid two">
<div>
<div class="subhead">Hourly rate</div>
<div class="input"><span class="prefix">$</span><input id="p_hourly" inputmode="decimal" placeholder="0.00"/></div>
</div>
<div>
<div class="subhead">Regular hours</div>
<div class="input"><input id="p_hours_reg" inputmode="decimal" placeholder="80" value="80"/></div>
</div>
<div>
<div class="subhead">Overtime hours</div>
<div class="input"><input id="p_hours_ot" inputmode="decimal" placeholder="0"/></div>
</div>
<div>
<div class="subhead">Overtime multiplier</div>
<div class="input"><input id="p_ot_mult" inputmode="decimal" placeholder="1.5" value="1.5"/></div>
</div>
<div>
<div class="subhead">Pre-tax deductions (this paycheck)</div>
<div class="input"><span class="prefix">$</span><input id="p_pretax" inputmode="decimal" placeholder="0.00"/></div>
</div>
<div>
<div class="subhead">YTD wages for Social Security</div>
<div class="input"><span class="prefix">$</span><input id="p_ytd" inputmode="decimal" placeholder="0.00"/></div>
</div>
<div>
<div class="subhead">Filing status</div>
<div class="input">
<select id="p_status">
<option value="single">Single</option>
<option value="married">Married filing jointly</option>
<option value="hoh">Head of household</option>
</select>
</div>
</div>
<div>
<div class="subhead">Pay frequency</div>
<div class="input">
<select id="p_freq">
<option selected="" value="biweekly">Biweekly (26/yr)</option>
<option value="weekly">Weekly (52/yr)</option>
<option value="semimonthly">Semi-monthly (24/yr)</option>
<option value="monthly">Monthly (12/yr)</option>
</select>
</div>
</div>
</div>
<div class="grid" style="margin-top:6px">
<div class="row"><span>Gross Pay</span><b id="p_gross">$0.00</b></div>
<div class="row"><span>Federal Income Tax (est.)</span><b class="neg" id="p_fed">$0.00</b></div>
<div class="row"><span>New Mexico Income Tax (est.)</span><b class="neg" id="p_state">$0.00</b></div>
<div class="row"><span>Social Security 6.2%</span><b class="neg" id="p_ss">$0.00</b></div>
<div class="row"><span>Medicare 1.45%</span><b class="neg" id="p_medicare">$0.00</b></div>
<div class="row"><span>Net Pay (take-home)</span><b class="net" id="p_net">$0.00</b></div>
<p class="hint">Estimates only. Uses 2025 federal brackets, 2025 standard deduction, and current NM brackets. Social Security respects your YTD cap. Pre-tax reduces federal/state taxable wages only.</p>
</div>
</div>
</section>
<!-- TIME -->
<section aria-labelledby="tab-time" id="screen-time" role="tabpanel">
<div class="card">
<h2 class="title">Your Time &amp; Their Time</h2>
<div class="grid two">
<div>
<div class="subhead">Your Airport (default ABQ)</div>
<div class="input"><input id="t_from" list="iataList" placeholder="Enter code" value="ABQ"/></div>
</div>
<div>
<div class="subhead">Their Airport</div>
<div class="input"><input id="t_to" list="iataList" placeholder="Enter code"/></div>
</div>
</div>
<div class="grid two" style="margin-top:8px">
<div>
<div class="subhead">Set Your Time (at your airport)</div>
<div class="input"><input id="t_when" type="datetime-local"/></div>
</div>
<div style="display:flex;align-items:flex-end"><button class="btn" id="t_now" style="width:100%">Use current time</button></div>
</div>
<div class="grid" style="margin-top:8px">
<div class="row"><strong>Your Time:</strong> <span id="t_from_out">‚Äî</span></div>
<div class="row"><strong>Their Time:</strong> <span id="t_to_out">‚Äî</span></div>
<div class="row" id="t_offset_display"><strong>Offset:</strong> <span id="t_offset_txt">‚Äî</span></div>
</div>
</div>
</section>
<!-- SW POINTS -->
<section aria-labelledby="tab-sw" id="screen-sw" role="tabpanel">
<div class="card">
<h2 class="title">Southwest Points per Dollar</h2>
<div class="subhead">How do you want to enter price?</div>
<div aria-label="Price entry mode" class="mode" role="tablist">
<button aria-selected="true" class="active" id="sw-mode-base" role="tab">I know the base fare</button>
<button id="sw-mode-est" role="tab">Estimate base from total</button>
</div>
<div class="grid two" id="sw-inputs" style="margin-top:10px">
<div id="sw-baseFareBlock">
<div class="subhead">Base fare (excluding taxes/fees)</div>
<div class="input"><span class="prefix">$</span><input id="sw-baseFare" inputmode="decimal" min="0" placeholder="e.g., 175.00" step="0.01" type="number"/></div>
</div>
<div id="sw-totalPriceBlock">
<div class="subhead">Total ticket price charged to card</div>
<div class="input"><span class="prefix">$</span><input id="sw-totalPrice" inputmode="decimal" min="0" placeholder="e.g., 225.00" step="0.01" type="number"/></div>
</div>
<div id="sw-basePctBlock" style="display:none">
<div class="subhead">If estimating: percent of total that is base fare</div>
<div class="input"><input id="sw-basePct" max="100" min="0" step="1" type="number" value="70"/><span class="prefix">%</span></div>
<p class="hint">If you do not know the base fare, a 60‚Äì80% range is common. Adjust as needed.</p>
</div>
<div>
<div class="subhead">Fare type</div>
<div class="input">
<select id="sw-fareType">
<option value="2">Basic ¬∑ 2 pts/$</option>
<option value="6">Choice ¬∑ 6 pts/$</option>
<option value="10">Choice Preferred ¬∑ 10 pts/$</option>
<option value="14">Choice Extra ¬∑ 14 pts/$</option>
</select>
</div>
</div>
</div>
<div class="grid" style="margin-top:6px">
<div class="row"><label><input id="sw-useCard" type="checkbox"/> Use a Southwest credit card for purchase</label></div>
<div class="grid two" id="sw-cardRow" style="display:none">
<div>
<div class="subhead">Select your Southwest card</div>
<div class="input">
<select id="sw-cardType">
<option value="2">Southwest Plus ¬∑ 2X</option>
<option value="3">Southwest Premier ¬∑ 3X</option>
<option value="4">Southwest Priority ¬∑ 4X</option>
<option value="3">Premier Business ¬∑ 3X</option>
<option value="4">Performance Business ¬∑ 4X</option>
</select>
</div>
<p class="hint">Applies the correct multiplier to the card charge.</p>
</div>
</div>
</div>
<div class="grid two" style="margin-top:8px">
<div class="pill">
<h3>Flight points</h3>
<span class="big hl" id="sw-flightPts">0</span>
</div>
<div class="pill">
<h3>Credit card points</h3>
<span class="big hl2" id="sw-cardPts">0</span>
</div>
<div class="pill">
<h3>Total points</h3>
<span class="big ok" id="sw-totalPts">0</span>
</div>
<div class="pill">
<h3>Effective pts per $</h3>
<span class="big" id="sw-ppd">0.00</span>
</div>
</div>
<p class="hint" style="margin-top:8px">Estimates flight points on base fare and card points on total charge.</p>
</div>
<!-- Converter -->
<div class="card">
<h2 class="title">Points to Dollars</h2>
<div class="grid two">
<div>
<div class="subhead">Points to redeem</div>
<div class="input"><input id="sw-pointsInput" min="0" placeholder="e.g., 12500" step="1" type="number"/></div>
</div>
<div>
<div class="subhead">Value per point (USD)</div>
<div class="input"><input id="sw-pointValue" min="0" step="0.0001" type="number" value="0.0149"/></div>
<p class="hint">Defaults to $0.0149 per point. Adjust as needed.</p>
</div>
</div>
<div class="grid two" style="margin-top:8px">
<div class="pill">
<h3>Estimated dollar cost</h3>
<span class="big ok" id="sw-dollarValue">$0.00</span>
</div>
<div class="pill">
<h3>Cents per point</h3>
<span class="big hl" id="sw-cpp">1.49¬¢</span>
</div>
</div>
</div>
</section>
</div>
<datalist id="iataList"></datalist>
<div class="sa-bottom"></div>
</main>
<nav aria-label="Bottom tabs" class="tabbar" role="tablist">
<div class="tabs">
<button aria-selected="true" class="tab active" data-screen="dash" id="tab-dash">üìä Dashboard</button>
<button aria-selected="false" class="tab" data-screen="tip" id="tab-tip">üíµ Tip</button>
<button class="tab" data-screen="salary" id="tab-salary">üìà Salary</button>
<button class="tab" data-screen="pay" id="tab-pay">üßæ Paycheck</button>
<button class="tab" data-screen="time" id="tab-time">‚è±Ô∏è Time</button>
<button class="tab" data-screen="sw" id="tab-sw">‚úàÔ∏è Points</button>
</div>
</nav>
</div>
<script>
function formatNewsTimestamp(ts){
  if(!ts) return '';
  let [date,time] = ts.split(' ');
  return `<span class="news-date">${date}</span> <span class="news-timepart">${time}</span>`;
}

    // Helpers
    const $ = s=>document.querySelector(s);
    const $$ = s=>[...document.querySelectorAll(s)];
    const nf = new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'});
    const setTitle = t => $('#appTitle').textContent = t;

    // Bottom tab routing
    const SCREENS = ['dash','tip','salary','pay','time','sw'];
    const TITLES = {dash:'Dashboard', tip:'Tip Calculator', salary:'Salary Calculator', pay:'Paycheck After Taxes', time:'Your Time & Their Time', sw:'Southwest Points'};

    function show(screen){
      SCREENS.forEach(id=>{
        const tab = $('#tab-' + id);
        const panel = $('#screen-' + id);
        const active = id === screen;
        tab.classList.toggle('active', active);
        tab.setAttribute('aria-selected', String(active));
        panel.classList.toggle('active', active);
      });
      setTitle(TITLES[screen] || 'Tools');
      history.replaceState(null,'','#' + screen);
      $('#content').focus({preventScroll:true});
      document.scrollingElement.scrollLeft = 0;
    }

    function initFromHash(){
      const h = location.hash.replace('#','');
      if(SCREENS.includes(h)) {
        show(h);
      } else {
        show('dash');
      }
    }

    // Header buttons
    $('#btnBack').addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));
    $('#btnCopy').addEventListener('click',()=>{
      if($('#screen-tip').classList.contains('active')){
        const bill=$('#bill'), percentOut=$('#percentOut'), tipOut=$('#tipOut'), totalOut=$('#totalOut');
        const s=`Bill: ${bill.value||nf.format(0)}\\nTip: ${percentOut.textContent}\\nTip Amount: ${tipOut.textContent}\\nTotal: ${totalOut.textContent}`;
        navigator.clipboard.writeText(s).catch(()=>{});
      } else {
        navigator.clipboard.writeText($('#appTitle').textContent).catch(()=>{});
      }
    });

    // Tab clicks
    $$('.tab').forEach(btn=>btn.addEventListener('click',()=>show(btn.dataset.screen)));
    window.addEventListener('hashchange', initFromHash);
    initFromHash();

    initTools();


    
    
// ===== TIP CALCULATOR =====
function parseNumInput(el){
  if(!el) return 0;
  const raw = (el.value || '').replace(/,/g,'').trim();
  const n = parseFloat(raw);
  return isNaN(n) ? 0 : n;
}
function fmtMoney(n){
  return nf.format(isNaN(n) ? 0 : n);
}

function updateTipCalc(useCustom){
  const billInput = document.getElementById('bill');
  const customInput = document.getElementById('customTip');
  const bill = parseNumInput(billInput);
  let pct = 0;

  if(useCustom){
    pct = parseNumInput(customInput);
  } else {
    const activeBtn = document.querySelector('.btn.tip.active');
    if(activeBtn) pct = parseFloat(activeBtn.dataset.tip || '0') || 0;
    if(!pct && customInput){
      const customVal = parseNumInput(customInput);
      if(customVal) pct = customVal;
    }
  }

  const tip = bill * pct / 100;
  const total = bill + tip;

  const tipOut = document.getElementById('tipOut');
  const totalOut = document.getElementById('totalOut');
  const percentOut = document.getElementById('percentOut');

  if(tipOut) tipOut.textContent = fmtMoney(tip);
  if(totalOut) totalOut.textContent = fmtMoney(total);
  if(percentOut) percentOut.textContent = (pct || 0) + '%';
}

function initTipCalc(){
  const bill = document.getElementById('bill');
  const customTip = document.getElementById('customTip');
  const resetBtn = document.getElementById('reset');
  const copyBtn = document.getElementById('copy');
  const tipBtns = [...document.querySelectorAll('.btn.tip')];

  tipBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
      tipBtns.forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      if(customTip) customTip.value = '';
      updateTipCalc(false);
    });
  });

  if(bill){
    bill.addEventListener('input',()=>updateTipCalc(false));
  }
  if(customTip){
    customTip.addEventListener('input',()=>{
      tipBtns.forEach(b=>b.classList.remove('active'));
      updateTipCalc(true);
    });
  }
  if(resetBtn){
    resetBtn.addEventListener('click',()=>{
      if(bill) bill.value = '';
      if(customTip) customTip.value = '';
      tipBtns.forEach(b=>b.classList.remove('active'));
      const tipOut = document.getElementById('tipOut');
      const totalOut = document.getElementById('totalOut');
      const percentOut = document.getElementById('percentOut');
      if(tipOut) tipOut.textContent = fmtMoney(0);
      if(totalOut) totalOut.textContent = fmtMoney(0);
      if(percentOut) percentOut.textContent = '0%';
    });
  }
  if(copyBtn){
    copyBtn.addEventListener('click',()=>{
      const btnCopy = document.getElementById('btnCopy');
      if(btnCopy) btnCopy.click();
    });
  }
}

// ===== SALARY CALCULATOR =====
function updateSalaryCalc(source){
  const hEl = document.getElementById('hourly');
  const mEl = document.getElementById('monthly');
  const aEl = document.getElementById('annual');
  if(!hEl || !mEl || !aEl) return;

  let h = parseNumInput(hEl);
  let m = parseNumInput(mEl);
  let a = parseNumInput(aEl);
  const HOURS_PER_YEAR = 2080;

  if(source === 'hourly'){
    a = h * HOURS_PER_YEAR;
    m = a / 12;
    // update only other fields so user can finish typing hourly
    mEl.value = m ? m.toFixed(2) : '';
    aEl.value = a ? a.toFixed(2) : '';
  } else if(source === 'monthly'){
    a = m * 12;
    h = a / HOURS_PER_YEAR;
    hEl.value = h ? h.toFixed(2) : '';
    aEl.value = a ? a.toFixed(2) : '';
  } else if(source === 'annual'){
    a = a;
    m = a / 12;
    h = a / HOURS_PER_YEAR;
    hEl.value = h ? h.toFixed(2) : '';
    mEl.value = m ? m.toFixed(2) : '';
  }
}

function initSalaryCalc(){
  const hEl = document.getElementById('hourly');
  const mEl = document.getElementById('monthly');
  const aEl = document.getElementById('annual');
  if(hEl) hEl.addEventListener('input',()=>updateSalaryCalc('hourly'));
  if(mEl) mEl.addEventListener('input',()=>updateSalaryCalc('monthly'));
  if(aEl) aEl.addEventListener('input',()=>updateSalaryCalc('annual'));
}

// ===== PAYCHECK CALCULATOR (NM ESTIMATE) =====
function estimateFedRate(annualTaxable, status){
  if(annualTaxable <= 0) return 0;
  if(status === 'married'){
    if(annualTaxable < 25000) return 0.10;
    if(annualTaxable < 90000) return 0.12;
    if(annualTaxable < 190000) return 0.22;
    return 0.24;
  }
  if(status === 'hoh'){
    if(annualTaxable < 20000) return 0.10;
    if(annualTaxable < 80000) return 0.12;
    if(annualTaxable < 160000) return 0.22;
    return 0.24;
  }
  // single (default)
  if(annualTaxable < 12000) return 0.10;
  if(annualTaxable < 45000) return 0.12;
  if(annualTaxable < 95000) return 0.22;
  return 0.24;
}

function initPaycheckCalc(){
  const inputs = [
    'p_hourly','p_hours_reg','p_hours_ot',
    'p_pre','p_post','p_ytd','p_extra'
  ];
  function getVal(id){
    const el = document.getElementById(id);
    if(!el) return 0;
    return parseNumInput(el);
  }
  function runPaycheck(){
    const hourly = getVal('p_hourly');
    const regHrs = getVal('p_hours_reg');
    const otHrs = getVal('p_hours_ot');
    const pre = getVal('p_pre');
    const post = getVal('p_post');
    const extra = getVal('p_extra');
    const statusEl = document.getElementById('p_status');
    const freqEl = document.getElementById('p_freq');
    const status = statusEl ? statusEl.value : 'single';
    const freq = freqEl ? freqEl.value : 'biweekly';

    const gross = hourly * regHrs + hourly * 1.5 * otHrs;

    const freqFactor =
      freq === 'weekly' ? 52 :
      freq === 'biweekly' ? 26 :
      freq === 'semimonthly' ? 24 :
      freq === 'monthly' ? 12 : 26;

    const taxable = Math.max(0, gross - pre);
    const annualTaxable = taxable * freqFactor;
    const fedRate = estimateFedRate(annualTaxable, status);
    const stateRate = 0.049; // simple NM estimate

    const fed = taxable * fedRate / 1; // per-check
    const state = taxable * stateRate;
    const ss = gross * 0.062;
    const medicare = gross * 0.0145;

    const totalTaxes = fed + state + ss + medicare + extra;
    const net = gross - totalTaxes - post;

    const set = (id, val)=>{
      const el = document.getElementById(id);
      if(el) el.textContent = fmtMoney(val);
    };

    set('p_gross', gross);
    set('p_fed', -fed);
    set('p_state', -state);
    set('p_ss', -ss);
    set('p_medicare', -medicare);
    set('p_net', net);
  }

  inputs.forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.addEventListener('input', runPaycheck);
  });
  const statusEl = document.getElementById('p_status');
  const freqEl = document.getElementById('p_freq');
  if(statusEl) statusEl.addEventListener('change', runPaycheck);
  if(freqEl) freqEl.addEventListener('change', runPaycheck);

  runPaycheck();
}

// ===== SOUTHWEST POINTS =====
function initSWPoints(){
  const baseFareEl = document.getElementById('sw-baseFare');
  const totalPriceEl = document.getElementById('sw-totalPrice');
  const basePctEl = document.getElementById('sw-basePct');
  const fareTypeEl = document.getElementById('sw-fareType');
  const useCardEl = document.getElementById('sw-useCard');
  const cardTypeEl = document.getElementById('sw-cardType');
  const modeBaseBtn = document.getElementById('sw-mode-base');
  const modeEstBtn = document.getElementById('sw-mode-est');
  const baseBlock = document.getElementById('sw-baseFareBlock');
  const basePctBlock = document.getElementById('sw-basePctBlock');
  const totalPriceBlock = document.getElementById('sw-totalPriceBlock');

  const flightPtsEl = document.getElementById('sw-flightPts');
  const cardPtsEl = document.getElementById('sw-cardPts');
  const totalPtsEl = document.getElementById('sw-totalPts');
  const ppdEl = document.getElementById('sw-ppd');

  const pointsInputEl = document.getElementById('sw-pointsInput');
  const pointValueEl = document.getElementById('sw-pointValue');
  const dollarsOutEl = document.getElementById('sw-dollarValue');
  const cppEl = document.getElementById('sw-cpp');

  function currentMode(){
    return modeEstBtn && modeEstBtn.classList.contains('active') ? 'est' : 'base';
  }

  function updateModeUI(mode){
    if(!modeBaseBtn || !modeEstBtn) return;
    if(mode === 'est'){
      modeBaseBtn.classList.remove('active');
      modeBaseBtn.setAttribute('aria-selected','false');
      modeEstBtn.classList.add('active');
      modeEstBtn.setAttribute('aria-selected','true');
      if(baseBlock) baseBlock.style.display = 'none';
      if(basePctBlock) basePctBlock.style.display = '';
      if(totalPriceBlock) totalPriceBlock.style.display = '';
    } else {
      modeBaseBtn.classList.add('active');
      modeBaseBtn.setAttribute('aria-selected','true');
      modeEstBtn.classList.remove('active');
      modeEstBtn.setAttribute('aria-selected','false');
      if(baseBlock) baseBlock.style.display = '';
      if(basePctBlock) basePctBlock.style.display = 'none';
      if(totalPriceBlock) totalPriceBlock.style.display = '';
    }
  }

  function runSW(){
    const mode = currentMode();
    const baseFare = parseNumInput(baseFareEl);
    const totalPrice = parseNumInput(totalPriceEl);
    const basePct = basePctEl ? parseNumInput(basePctEl) : 0;
    const fareMult = fareTypeEl ? parseFloat(fareTypeEl.value || '0') || 0 : 0;

    let usedBase = 0;
    let usedTotal = totalPrice;

    if(mode === 'base'){
      usedBase = baseFare;
      if(!usedTotal) usedTotal = baseFare;
    } else {
      usedTotal = totalPrice;
      const pct = basePct / 100;
      usedBase = usedTotal * (pct || 0);
    }

    const flightPts = usedBase * fareMult;
    let cardPts = 0;
    if(useCardEl && useCardEl.checked){
      const cardMult = cardTypeEl ? parseFloat(cardTypeEl.value || '0') || 0 : 0;
      cardPts = usedTotal * cardMult;
    }
    const totalPts = flightPts + cardPts;
    const dollarsBase = usedTotal || usedBase || 0;
    const ppd = dollarsBase ? totalPts / dollarsBase : 0;

    if(flightPtsEl) flightPtsEl.textContent = Math.round(flightPts).toLocaleString('en-US');
    if(cardPtsEl) cardPtsEl.textContent = Math.round(cardPts).toLocaleString('en-US');
    if(totalPtsEl) totalPtsEl.textContent = Math.round(totalPts).toLocaleString('en-US');
    if(ppdEl) ppdEl.textContent = ppd.toFixed(2);

    const pts = parseNumInput(pointsInputEl);
    const valuePerPoint = pointValueEl ? parseNumInput(pointValueEl) : 0;
    const dollarValue = pts * valuePerPoint;
    const cpp = valuePerPoint * 100;

    if(dollarsOutEl) dollarsOutEl.textContent = fmtMoney(dollarValue);
    if(cppEl) cppEl.textContent = cpp.toFixed(2) + '¬¢';
  }

  if(modeBaseBtn){
    modeBaseBtn.addEventListener('click',()=>{
      updateModeUI('base');
      runSW();
    });
  }
  if(modeEstBtn){
    modeEstBtn.addEventListener('click',()=>{
      updateModeUI('est');
      runSW();
    });
  }

  if(useCardEl){
    useCardEl.addEventListener('change',()=>{
      const row = document.getElementById('sw-cardRow');
      if(row) row.style.display = useCardEl.checked ? '' : 'none';
      runSW();
    });
  }

  [baseFareEl,totalPriceEl,basePctEl,fareTypeEl,cardTypeEl,pointsInputEl,pointValueEl].forEach(el=>{
    if(el){
      el.addEventListener('input', runSW);
      el.addEventListener('change', runSW);
    }
  });

  updateModeUI(currentMode());
  runSW();
}

// Initialize calculators/tools
function initTools(){
  initTipCalc();
  initSalaryCalc();
  initPaycheckCalc();
  initSWPoints();
}

// ===== DASHBOARD CLOCKS & WEATHER =====
    const CLOCKS = [
      {id:'clock-hi', tz:'Pacific/Honolulu'},
      {id:'clock-pt', tz:'America/Los_Angeles'},
      {id:'clock-mt', tz:'America/Denver'},
      {id:'clock-ct', tz:'America/Chicago'},
      {id:'clock-et', tz:'America/New_York'},
      {id:'clock-z',  tz:'UTC'}
    ];

    function formatClock(date, tz){
      const parts = new Intl.DateTimeFormat('en-US',{
        timeZone: tz,
        hour:'2-digit',
        minute:'2-digit',
        hour12:true
      }).formatToParts(date);
      const lookup = Object.fromEntries(parts.map(p=>[p.type,p.value]));
      return lookup.hour + ':' + lookup.minute + ' ' + lookup.dayPeriod.toUpperCase();
    }

    function tickClocks(){
      const now = new Date();
      CLOCKS.forEach(c=>{
        const el = document.getElementById(c.id);
        if(!el) return;
        el.textContent = formatClock(now, c.tz);
  // update date
  const dateStr = new Intl.DateTimeFormat('en-US',{
      month:'2-digit', day:'2-digit'
  }).format(now);
  const dateEl = document.getElementById(c.id.replace('clock','date'));
  const dEl = document.querySelector('#'+c.id).parentElement.querySelector('.clock-date');
  if(dEl) dEl.textContent = dateStr;

      });
    }
    tickClocks();
    setInterval(tickClocks, 1000);

    // Simple WMO weathercode to text
    const WMO_TEXT = {
      0:'Clear sky',
      1:'Mainly clear',
      2:'Partly cloudy',
      3:'Overcast',
      45:'Fog',
      48:'Depositing rime fog',
      51:'Light drizzle',
      53:'Moderate drizzle',
      55:'Dense drizzle',
      61:'Light rain',
      63:'Moderate rain',
      65:'Heavy rain',
      71:'Light snow',
      73:'Moderate snow',
      75:'Heavy snow',
      80:'Rain showers',
      81:'Rain showers',
      82:'Heavy rain showers',
      85:'Snow showers',
      86:'Snow showers',
      95:'Thunderstorm',
      96:'Thunderstorm w/ hail',
      99:'Thunderstorm w/ hail'
    };

    async function loadWeather(){
      const curBox = document.getElementById('wx-current');
      const next8 = document.getElementById('wx-next8');
      const next8b = document.getElementById('wx-next8b');
      if(!curBox || !next8 || !next8b) return;
      try{
        const url = 'https://api.open-meteo.com/v1/forecast?latitude=35.0844&longitude=-106.6504&current_weather=true&hourly=temperature_2m,weathercode&daily=temperature_2m_max,temperature_2m_min,weathercode&temperature_unit=fahrenheit&timezone=America%2FDenver';
        const res = await fetch(url);
        const data = await res.json();
        const cur = data.current_weather || {};
        const hours = data.hourly || {};
        const times = hours.time || [];
        const temps = hours.temperature_2m || [];
        const codes = hours.weathercode || [];
        const nowIso = cur.time || times[0];

// Daily data for tomorrow's summary
const daily = data.daily || {};
const dTimes = daily.time || [];
const dMax = daily.temperature_2m_max || [];
const dMin = daily.temperature_2m_min || [];
const dCodes = daily.weathercode || [];

const tomorrowBox = document.getElementById('wx-tomorrow');
if (tomorrowBox && dTimes.length) {
  // Figure out which daily index is "tomorrow" relative to current day
  const curDay = (nowIso || dTimes[0] || '').split('T')[0];
  let todayIdx = dTimes.indexOf(curDay);
  if (todayIdx < 0) todayIdx = 0;
  const tomorrowIdx = todayIdx + 1 < dTimes.length ? todayIdx + 1 : todayIdx;

  const hi = dMax[tomorrowIdx];
  const lo = dMin[tomorrowIdx];
  const codeVal = dCodes[tomorrowIdx];

  const hiEl = document.getElementById('wx-tomorrow-hi');
  const condEl2 = document.getElementById('wx-tomorrow-cond');
  const extraEl2 = document.getElementById('wx-tomorrow-extra');

  if (hiEl) hiEl.textContent = Math.round(hi ?? 0) + '¬∞';
  if (condEl2) condEl2.textContent = WMO_TEXT[codeVal] || 'Tomorrow\'s weather';

  if (extraEl2) {
    const labelDate = dTimes[tomorrowIdx] ? new Date(dTimes[tomorrowIdx]).toLocaleDateString('en-US',{
      month:'2-digit', day:'2-digit'
    }) : '';
    extraEl2.textContent = 'High ' + Math.round(hi ?? 0) + '¬∞ / Low ' + Math.round(lo ?? 0) + '¬∞' + (labelDate ? ' ¬∑ ' + labelDate : '');
  }
}

        // Fill current
        const tempEl = curBox.querySelector('.wx-temp');
        const condEl = curBox.querySelector('.wx-cond');
        const extraEl = curBox.querySelector('.wx-extra');
        if(tempEl) tempEl.textContent = Math.round(cur.temperature ?? 0) + '¬∞';
        if(condEl) condEl.textContent = WMO_TEXT[cur.weathercode] || 'Current conditions';
        if(extraEl) extraEl.textContent = 'Updated ' + (nowIso || '').replace('T',' ');

        // Find index of the hour closest to now in the hourly array
        let idx = 0;
        if(times.length){
          const now = new Date();
          let bestDiff = Infinity;
          times.forEach((t,i)=>{
            const d = new Date(t);
            const diff = Math.abs(d - now);
            if(diff < bestDiff){
              bestDiff = diff;
              idx = i;
            }
          });
        }

        
        function buildHourCell(timeStr, temp, code){
          const d = new Date(timeStr);
          const parts = new Intl.DateTimeFormat('en-US',{
            hour:'numeric', minute:'2-digit', hour12:true
          }).formatToParts(d);
          const lu = Object.fromEntries(parts.map(p=>[p.type,p.value]));
          const label = lu.hour + ':' + lu.minute + ' ' + lu.dayPeriod;
          const div = document.createElement('div');
          div.className = 'wx-hour';
          div.innerHTML = `
            <div class="wx-hour-time">${label}</div>
            <div class="wx-hour-temp">${Math.round(temp)}¬∞</div>
            <div class="wx-hour-cond">${WMO_TEXT[code] || ''}</div>
          `;
          return div;
        }

        next8.innerHTML = '';
        next8b.innerHTML = '';

        for(let i=idx; i<idx+8 && i<times.length; i++){
          next8.appendChild(buildHourCell(times[i], temps[i], codes[i]));
        }
        for(let i=idx+8; i<idx+16 && i<times.length; i++){
          next8b.appendChild(buildHourCell(times[i], temps[i], codes[i]));
        }

      }catch(err){
        const extraEl = document.getElementById('wx-extra');
        if(extraEl) extraEl.textContent = 'Unable to load weather right now.';
      }
    }

    const NEWS_URL = 'https://gnews.io/api/v4/top-headlines?category=general&lang=en&country=us&max=12&apikey=demo';

    const FALLBACK_ARTICLES = [
  {
    title: 'Trump acknowledges slide in approval ratings',
    description: 'President Donald Trump admitted his poll numbers have fallen as voters react to high living costs and the Epstein investigation pressure on his administration.'
  },
  {
    title: 'Justice Department to release Epstein investigation files',
    description: 'Attorney General Pam Bondi said the U.S. Justice Department will publish files on the late Jeffrey Epstein within 30 days after Congress pushed for transparency.'
  },
  {
    title: 'White House freezes billions for Democratic-led states',
    description: 'The administration halted funding for transit and green-energy projects in Democratic-leaning states during the government shutdown, escalating the partisan budget standoff.'
  },
  {
    title: 'Government data blackout worries global policymakers',
    description: 'A shutdown-driven halt in key U.S. economic releases is making it harder for officials abroad to read the health of the world‚Äôs largest economy.'
  },
  {
    title: 'U.S. outlets protest new Pentagon press access rules',
    description: 'More than two dozen news organizations refused to sign a revised Pentagon access policy, warning it could limit independent reporting on the military.'
  },
  {
    title: 'U.S. strike on Caribbean drug vessel leaves survivors',
    description: 'A recent U.S. military strike on a suspected drug-smuggling vessel in the Caribbean reportedly left survivors, a first in this type of operation, an official said.'
  }
];

    async function loadNews(){
      const box = document.getElementById('news-list');
      if(!box) return;

      function renderArticles(list){
        if(!list || !list.length){
          box.innerHTML = '<p class="hint">No headlines available.</p>';
          return;
        }
        box.innerHTML = '';
        list.forEach(a=>{
          const item = document.createElement('article');
          item.className = 'news-item';
          const title = a.title || 'Untitled';
          const summary = (a.description || '').trim();
          const short = summary.length > 180 ? summary.slice(0,177) + '‚Ä¶' : summary;
          const now = new Date();
          const dateStr = now.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"});
          const timeStr = now.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:true});
          item.innerHTML =
            '<div class="news-title">'+title+'</div>' +
            '<div class="news-summary">'+(short || 'No summary available.')+'</div>' +
            '<div class="news-time">' +
              '<span class="news-date">'+dateStr+'</span> ' +
              '<span class="news-timepart">'+timeStr+'</span>' +
            '</div>';
          box.appendChild(item);
        });
      }

      // Option C: static Reuters-style feed only
      renderArticles(FALLBACK_ARTICLES);
    }

    loadWeather();
    loadNews();

// ===== TIME =====
    const IATA_TZ={
      ALB:'America/New_York', ABQ:'America/Denver', ANC:'America/Anchorage', AMA:'America/Chicago', ATL:'America/New_York', AUS:'America/Chicago',
      BWI:'America/New_York', BHM:'America/Chicago', BOI:'America/Boise', BOS:'America/New_York', BZN:'America/Denver', BUF:'America/New_York', BUR:'America/Los_Angeles',
      CHS:'America/New_York', CLT:'America/New_York', MDW:'America/Chicago', ORD:'America/Chicago', CVG:'America/New_York', CLE:'America/New_York', COS:'America/Denver',
      CMH:'America/New_York', CRP:'America/Chicago', DAL:'America/Chicago', DEN:'America/Denver', DSM:'America/Chicago', VPS:'America/Chicago', DTW:'America/Detroit',
      ELP:'America/Denver', EUG:'America/Los_Angeles', FLL:'America/New_York', RSW:'America/New_York', FAT:'America/Los_Angeles', GRR:'America/Detroit', GSP:'America/New_York',
      HRL:'America/Chicago', BDL:'America/New_York', HOU:'America/Chicago', IND:'America/Indiana/Indianapolis', JAN:'America/Chicago', JAX:'America/New_York',
      MCI:'America/Chicago', TYS:'America/New_York', LAS:'America/Los_Angeles', LIT:'America/Chicago', LGB:'America/Los_Angeles', ISP:'America/New_York', LAX:'America/Los_Angeles',
      SDF:'America/Kentucky/Louisville', LBB:'America/Chicago', MHT:'America/New_York', MEM:'America/Chicago', MIA:'America/New_York', MAF:'America/Chicago', MKE:'America/Chicago',
      MSP:'America/Chicago', MTJ:'America/Denver', MYR:'America/New_York', BNA:'America/Chicago', MSY:'America/Chicago', LGA:'America/New_York', ORF:'America/New_York',
      OAK:'America/Los_Angeles', OKC:'America/Chicago', OMA:'America/Chicago', ONT:'America/Los_Angeles', SNA:'America/Los_Angeles', MCO:'America/New_York', PSP:'America/Los_Angeles',
      ECP:'America/Chicago', PNS:'America/Chicago', PHL:'America/New_York', PHX:'America/Phoenix', PIT:'America/New_York', PWM:'America/New_York', PDX:'America/Los_Angeles',
      PVD:'America/New_York', RDU:'America/New_York', RNO:'America/Los_Angeles', RIC:'America/New_York', ROC:'America/New_York', SMF:'America/Los_Angeles', SLC:'America/Denver',
      SAT:'America/Chicago', SAN:'America/Los_Angeles', SFO:'America/Los_Angeles', SJC:'America/Los_Angeles', SBA:'America/Los_Angeles', STS:'America/Los_Angeles',
      SRQ:'America/New_York', SAV:'America/New_York', SEA:'America/Los_Angeles', GEG:'America/Los_Angeles', STL:'America/Chicago', HDN:'America/Denver',
      TPA:'America/New_York', TUS:'America/Phoenix', TUL:'America/Chicago', IAD:'America/New_York', DCA:'America/New_York', PBI:'America/New_York', ICT:'America/Chicago',
      AUA:'America/Aruba', BZE:'America/Belize', CUN:'America/Cancun', GCM:'America/Cayman', HAV:'America/Havana', LIR:'America/Costa_Rica', SJD:'America/Mazatlan',
      MBJ:'America/Jamaica', NAS:'America/Nassau', PLS:'America/Grand_Turk', PVR:'America/Mexico_City', PUJ:'America/Santo_Domingo', SJO:'America/Costa_Rica',
      SJU:'America/Puerto_Rico', SXM:'America/Lower_Princes', STT:'America/St_Thomas', ITO:'Pacific/Honolulu', HNL:'Pacific/Honolulu', OGG:'Pacific/Honolulu',
      KOA:'Pacific/Honolulu', LIH:'Pacific/Honolulu'
    };
    const list=$('#iataList'); Object.keys(IATA_TZ).forEach(code=>{const o=document.createElement('option'); o.value=code; list.appendChild(o)});

    const t_from=$('#t_from'), t_to=$('#t_to'), t_when=$('#t_when'), t_now=$('#t_now');
    const t_from_out=$('#t_from_out'), t_to_out=$('#t_to_out'), t_offset_display=$('#t_offset_display'), t_offset_txt=$('#t_offset_txt');

    function setNow(){
      const fromCode=(t_from.value||'ABQ').toUpperCase(); const fromTZ=IATA_TZ[fromCode]||'America/Denver';
      const now=new Date(); const parts=new Intl.DateTimeFormat('sv-SE',{timeZone:fromTZ,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}).formatToParts(now);
      const P=Object.fromEntries(parts.map(p=>[p.type,p.value])); t_when.value=`${P.year}-${P.month}-${P.day}T${P.hour}:${P.minute}`;
    }
    function parseLocalToUTC(localStr,tz){ if(!localStr) return null; const [date,time]=localStr.split('T'); const[y,m,d]=date.split('-').map(Number); const[hh,mm]=time.split(':').map(Number);
      let guess=new Date(Date.UTC(y,m-1,d,hh,mm)); for(let i=0;i<3;i++){ const parts=new Intl.DateTimeFormat('sv-SE',{timeZone:tz,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}).formatToParts(guess);
        const P=Object.fromEntries(parts.map(p=>[p.type,p.value])); const diff=(Number(P.hour)*60+Number(P.minute))-(hh*60+mm); if(diff===0) break; guess=new Date(guess.getTime()-diff*60*1000);} return guess; }
    function fmtInTZ(d,tz){ return new Intl.DateTimeFormat('en-US',{timeZone:tz,month:'short',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:true}).format(d); }
    function getOffsetHours(fromTZ,toTZ,base){ const fromTime=new Date(base.toLocaleString('en-US',{timeZone:fromTZ})); const toTime=new Date(base.toLocaleString('en-US',{timeZone:toTZ})); return (toTime-fromTime)/(1000*60*60); }

    function runTime(){
      const fromCode=(t_from.value||'ABQ').toUpperCase(); const toCode=(t_to.value||'ABQ').toUpperCase();
      const fromTZ=IATA_TZ[fromCode]; const toTZ=IATA_TZ[toCode]; if(!fromTZ||!toTZ) return;
      const base=parseLocalToUTC(t_when.value,fromTZ); if(!base) return;
      t_from_out.textContent=`${fmtInTZ(base,fromTZ)} (${fromCode})`; t_to_out.textContent=`${fmtInTZ(base,toTZ)} (${toCode})`;
      const off=getOffsetHours(fromTZ,toTZ,base); let txt='Same Time'; if(off>0) txt=`+${off.toFixed(1)} hr`; else if(off<0) txt=`${off.toFixed(1)} hr`;
      t_offset_txt.textContent=txt;
      t_offset_display.className='row '+(off>0?'plus':off<0?'minus':'');
    }

    $('#t_now').addEventListener('click',()=>{setNow();runTime();});
    ['input','change'].forEach(e=>{
      t_from.addEventListener(e,()=>{setNow();runTime();});
      t_to.addEventListener(e,runTime);
      t_when.addEventListener(e,runTime);
    });
    setNow(); runTime();
  
// ===== Mobile-fit helpers (added) =====
(function(){
  const content = document.getElementById('content');
  const tabbar = document.querySelector('.tabbar');
  const tabs = document.querySelector('.tabs');

  function adjustBottomPadding(){
    if (!content || !tabbar) return;
    const h = tabbar.offsetHeight || 90;
    // Add a little breathing room above the tabbar
    content.style.paddingBottom = (h + 24) + 'px';
  }

  function toggleCompactTabs(){
    if (!tabs) return;
    // Icons-only on very narrow screens for better fit
    if (window.innerWidth <= 400) {
      tabs.classList.add('compact');
    } else {
      tabs.classList.remove('compact');
    }
  }

  // Run on load and whenever layout might change
  window.addEventListener('load', () => { adjustBottomPadding(); toggleCompactTabs(); });
  window.addEventListener('resize', () => { adjustBottomPadding(); toggleCompactTabs(); });
  window.addEventListener('orientationchange', () => { setTimeout(()=>{ adjustBottomPadding(); toggleCompactTabs(); }, 150); });

  // Also re-run after the home overlay is dismissed since heights can change
  const home = document.getElementById('homeOverlay');
  if (home) {
    const obs = new MutationObserver(adjustBottomPadding);
    obs.observe(home, { attributes: true, attributeFilter: ['class'] });
  }
})();


// ===== Keep Enter button clear of bottom UI (added) =====
(function(){
  const root = document.documentElement;
  const content = document.getElementById('content');
  const tabbar = document.querySelector('.tabbar');
  const home = document.getElementById('homeOverlay');

  function getTabbarHeight(){
    return (tabbar && tabbar.offsetHeight) ? tabbar.offsetHeight : 90;
  }

  function adjustLayoutForBottomUI(){
    const h = getTabbarHeight();
    // Expose the tabbar height to CSS
    root.style.setProperty('--tabbar-h', h + 'px');

    // Make sure main content doesn't slip under the tabbar
    if (content) content.style.paddingBottom = (h + 24) + 'px';

    // Ensure the home overlay (with Enter button) has enough bottom padding
    if (home) {
      // If your overlay toggles classes like 'hidden' or 'open', padding still applies
      home.style.paddingBottom = (h + 24) + 'px';
    }
  }

  // Run on load and when layout changes
  window.addEventListener('load', adjustLayoutForBottomUI);
  window.addEventListener('resize', adjustLayoutForBottomUI);
  window.addEventListener('orientationchange', () => setTimeout(adjustLayoutForBottomUI, 150));

  // Observe home overlay visibility/class changes so padding updates when opened/closed
  if (home && 'MutationObserver' in window) {
    const obs = new MutationObserver(adjustLayoutForBottomUI);
    obs.observe(home, { attributes: true, attributeFilter: ['class', 'style'] });
  }

  // Small delay to catch late layout shifts (fonts/icons)
  setTimeout(adjustLayoutForBottomUI, 300);
})();



// ===== AUTO REFRESH EVERY 15 MINUTES =====
function scheduleQuarterHourRefresh() {
  const now = new Date();
  const minutes = now.getMinutes();
  const seconds = now.getSeconds();
  const ms = now.getMilliseconds();

  const nextQuarter = Math.ceil(minutes / 15) * 15;
  const targetMinute = nextQuarter === 60 ? 0 : nextQuarter;

  let diffMinutes = targetMinute - minutes;
  if (diffMinutes <= 0) diffMinutes += 60;

  const delay =
    diffMinutes * 60 * 1000 -
    seconds * 1000 -
    ms;

  setTimeout(() => {
    location.reload();
  }, delay);
}

scheduleQuarterHourRefresh();


// ===== KEEP SCREEN AWAKE (Wake Lock API) =====
let wakeLock = null;

async function requestWakeLock() {
  try {
    if ('wakeLock' in navigator) {
      wakeLock = await navigator.wakeLock.request('screen');
      console.log('Wake Lock active');

      wakeLock.addEventListener('release', () => {
        console.log('Wake Lock released');
      });
    } else {
      console.log('Wake Lock API not supported in this browser.');
    }
  } catch (err) {
    console.log('Wake Lock error:', err);
  }
}

// Re-request wake lock when tab becomes visible again
document.addEventListener('visibilitychange', () => {
  if (document.visibilityState === 'visible') {
    requestWakeLock();
  }
});

// Initial activation
requestWakeLock();
</script>
</body>
</html>
